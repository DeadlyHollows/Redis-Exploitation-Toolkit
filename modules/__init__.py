from importlib import import_module
from pkgutil import iter_modules


AVAILABLE_ATTACKS = [
    { name: getattr(import_module(f".{name}", "modules"), "AVAILABLE_ATTACKS") }
    for _, name, _ in iter_modules(["modules"])
]



def get_available_attacks_help_message():
    return "\n[*] Available attack modules:\n\n" \
    "1. enum: to perform various enumeration attacks.\n" \
    "2. exec: to perform various command execution attacks.\n" \
    "3. module_load: to load a malicious Redis module.\n"