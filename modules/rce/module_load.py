from .common import get_attack_help_message


AVAILABLE_ATTACKS = [
    "load_malicious_module"
]



def module_load_help():
    return "\nUse this sub-module to load a malicious\n" \
    "Redis module on the target server. The Redis module\n" \
    "must be present on the server and must have execute\n"\
    "permissions.\n"



def perform_module_load_attack(attack_name):

    if attack_name not in AVAILABLE_ATTACKS:
        print ("\n[-]Invalid attack name specified!\n")
        return

    # getattr(import_module(f".{attack_name}", "modules.module_load"), attack_name)()
    getattr(locals[attack_name])()



def load_malicious_module_help():
    return get_attack_help_message("load_malicious_module")

def load_malicious_module():
    from .load_malicious_module import load_malicious_module
    load_malicious_module()



def get_available_attacks():
    return AVAILABLE_ATTACKS



if __name__ == "__main__":
    perform_module_load_attack(attack_name = "load_malicious_module")